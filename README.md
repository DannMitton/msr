# MSR (My Sung Russian) - Refactored Structure

## Phase-0 Modularization

This is the Phase-0 extraction of MSR from a monolithic `index.html` into a modular ES module structure.

### What Changed

**Before:** Single 7,033-line `index.html` with everything embedded  
**After:** Separated concerns with proper module structure

### Directory Structure

```
msr/
├── public/
│   ├── index.html          # Slim bootloader (HTML only)
│   ├── themes/
│   │   └── default.css     # Extracted from original (copy from css/styles.css)
│   └── msr.js              # Bundled output (generated by build)
├── src/
│   ├── index.js            # Entry point, re-exports public API
│   └── core/
│       └── transcript.js   # Complete transcription engine (6,400+ lines)
├── data/                   # Copy from existing repo
│   ├── vuizur.json         # 47k-word stress dictionary
│   ├── yo-exceptions.js    # Ё exception dictionary
│   ├── stress-corrections.js
│   └── exception-words.js
├── tests/                  # Copy from existing repo
│   ├── golden.js           # 66 golden master tests
│   ├── audit-exceptions.js
│   └── remove-redundant.js
├── package.json
├── build.mjs               # esbuild bundler
└── README.md
```

### Setup

1. Copy existing data files:
   ```bash
   cp -r /path/to/old/msr/data ./data
   cp -r /path/to/old/msr/tests ./tests
   cp /path/to/old/msr/css/styles.css ./public/themes/default.css
   ```

2. Install dependencies:
   ```bash
   npm install
   ```

3. Build:
   ```bash
   npm run build
   ```

4. Test:
   - Open `public/index.html` in browser
   - Open console, run `runGoldenTests()`
   - Expect: 66/66 passing

### What's Next (Phase 1+)

- Extract CSS into CSS custom properties for theming
- Split `transcript.js` into smaller modules
- Create UI components as custom elements
- Add schema system for multi-schema support (Belov, Walters)

### Golden Tests

The 66 golden tests are the "ABI contract" — they must pass at every phase.

Run in browser console:
```javascript
runGoldenTests()
```

### Credits

- **Developer:** Dann Mitton
- **Assistant:** Claude (Anthropic)
- **Architecture consultation:** KIMI
- **Transcription rules:** Craig Grayson, "Russian Lyric Diction" (2012)
